(this["webpackJsonpman-challenge"]=this["webpackJsonpman-challenge"]||[]).push([[0],{14:function(e,n,t){},15:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),o=t(8),s=t.n(o),l=(t(14),t(2)),c=t(3),r=t(5),m=t(4),p=t(6),u=t(1),d="AIzaSyBob70viGuD9PCxbg5xAwqYzuGuEQZR4qo";function h(){return new Promise((function(e,n){window.resolveGoogleMapsPromise=function(){e(window.google),delete window.resolveGoogleMapsPromise};var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=".concat(d,"&callback=resolveGoogleMapsPromise"),t.async=!0,document.body.appendChild(t)}))}var g=function(e){function n(e){var t;return Object(l.a)(this,n),(t=Object(r.a)(this,Object(m.a)(n).call(this,e))).state={license:"",poi:"all",radius:"5"},t.handlePOI=t.handlePOI.bind(Object(u.a)(t)),t.handleRadius=t.handleRadius.bind(Object(u.a)(t)),t.handleLicense=t.handleLicense.bind(Object(u.a)(t)),t.handleSubmit=t.handleSubmit.bind(Object(u.a)(t)),t}return Object(p.a)(n,e),Object(c.a)(n,[{key:"handleLicense",value:function(e){this.setState({license:e.target.value})}},{key:"handlePOI",value:function(e){this.setState({poi:e.target.value})}},{key:"handleRadius",value:function(e){this.setState({radius:e.target.value})}},{key:"handleSubmit",value:function(e){var n=this,t=[this.state.poi];"all"===this.state.poi&&(t=["gas station","restaurant","hotel"]);var a=h(),i=function(e){var n="https://man-challenge-api.herokuapp.com/vehicles/"+e;return fetch(n).then((function(e){return e.json()})).catch((function(){return console.log("Can\u2019t access "+n+" response. Blocked by browser?")}))}(this.state.license);Promise.all([a,i]).then((function(e){var a,i=e[0],o=e[1],s=Object.keys(o).length,l=o[s-1].lat+","+o[s-1].lng;n.map=new i.maps.Map(document.getElementById("map"),{zoom:18,scrollwheel:!0,center:{lat:o[s-1].lat,lng:o[s-1].lng}});var c,r,m=new i.maps.Size(25,25),p="imgs/icn-first-location.png",u=o[0].license,h=function(){"undefined"===typeof o[r+1]||o[r+1].license!==u?(p="imgs/icn-current-location.png",m=new i.maps.Size(40,40)):(m=new i.maps.Size(20,20),p="imgs/icn-path.png"),o[r].license!==u&&(u=o[r].license,m=new i.maps.Size(25,25),p="imgs/icn-first-location.png");var e=new i.maps.Marker({position:{lat:o[r].lat,lng:o[r].lng},map:n.map,id:o[r].id,animation:i.maps.Animation.DROP,icon:{url:p,scaledSize:m},license:u});i.maps.event.addListener(e,"click",(function(){var t='<div class="info_box"> <h3>License: '+e.license+"</h3> </div>";n.infowindow.setContent(t),n.map.setCenter(e.position),n.infowindow.open(n.map,e),n.map.panBy(0,-125),null!==e.getAnimation()?e.setAnimation(null):e.setAnimation(i.maps.Animation.BOUNCE),c.setAnimation(null),a=e.position,c=e})),c=e,a=e.position};for(r=0;r<s;r++)h();c.setAnimation(i.maps.Animation.BOUNCE),t.forEach((function(e){var t=function(e,n,t){var a="https://maps.googleapis.com/maps/api/place/textsearch/json?query="+e+"&type="+e+"&location="+n+"&radius="+t+"&key="+d;return fetch("https://cors-anywhere.herokuapp.com/"+a).then((function(e){return e.json()})).catch((function(){return console.log("Can\u2019t access "+a+" response. Blocked by browser?")}))}(e,l,n.state.radius);Promise.all([t]).then((function(e){var t=e[0].results;n.google=i,n.infowindow=new i.maps.InfoWindow,t.forEach((function(e){p="imgs/icn-hotel.png",e.types.indexOf("restaurant")>-1&&(p="imgs/icn-restaurant.png"),e.types.indexOf("gas_station")>-1&&(p="imgs/icn-gas-station.png");var t=new i.maps.Marker({position:{lat:e.geometry.location.lat,lng:e.geometry.location.lng},map:n.map,name:e.geometry.name,id:e.geometry.id,animation:i.maps.Animation.DROP,icon:{url:p,scaledSize:new i.maps.Size(50,50)}});i.maps.event.addListener(t,"click",(function(){var o=i.maps.geometry.spherical.computeDistanceBetween(t.getPosition(),a),s='<div class="info_box"><h3>Distance: '+Math.round(o)+"m</h3><h4>"+e.name+"</h4><p>"+e.formatted_address+'</p><img class="middlr" alt="'+e.name+'" src="'+e.icon+'" /></div>';n.infowindow.setContent(s),n.map.setCenter(t.position),n.infowindow.open(n.map,t),n.map.panBy(0,-125),null!==t.getAnimation()?t.setAnimation(null):t.setAnimation(i.maps.Animation.BOUNCE),setTimeout((function(){t.setAnimation(null)}),1500)}))}))}))}))})),e.preventDefault()}},{key:"render",value:function(){return i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:"display-box"},i.a.createElement("div",{className:"component-container"},i.a.createElement("input",{type:"text",value:this.state.license,onChange:this.handleLicense,className:"component-start",placeholder:"Search by license plate"})),i.a.createElement("div",{className:"component-container"},i.a.createElement("select",{value:this.state.poi,onChange:this.handlePOI,className:"component-middle"},i.a.createElement("option",{value:"all"},"View all"),i.a.createElement("option",{value:"gas station"},"Gas Stations"),i.a.createElement("option",{value:"restaurant"},"Restaurants"),i.a.createElement("option",{value:"hotel"},"Hotels"))),i.a.createElement("div",{className:"component-container"},i.a.createElement("select",{value:this.state.radius,onChange:this.handleRadius,className:"component-middle"},i.a.createElement("option",{value:"100"},"100 m"),i.a.createElement("option",{value:"200"},"200 m"),i.a.createElement("option",{value:"500"},"500 m"),i.a.createElement("option",{value:"750"},"750 m"),i.a.createElement("option",{value:"1000"},"1 km"),i.a.createElement("option",{value:"2000"},"2 km"),i.a.createElement("option",{value:"5000"},"5 km"),i.a.createElement("option",{value:"10000"},"10 km"),i.a.createElement("option",{value:"25000"},"25 km"),i.a.createElement("option",{value:"50000"},"50 km"))),i.a.createElement("div",{className:"component-container"},i.a.createElement("button",{type:"submit",className:"component-end"},"Apply"))))}}]),n}(i.a.Component),v=function(e){function n(){return Object(l.a)(this,n),Object(r.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=h();Promise.all([n]).then((function(n){var t=n[0];e.google=t,e.map=new t.maps.Map(document.getElementById("map"),{zoom:18,scrollwheel:!0,center:{lat:38.717121,lng:-9.14921}})}))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(g,null),i.a.createElement("div",{id:"map"}))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,n,t){e.exports=t(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.5dd5cf0c.chunk.js.map